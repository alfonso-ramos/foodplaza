<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>

<DialogPane xmlns:fx="http://javafx.com/fxml" 
            fx:controller="asedi.controllers.gerencia.ProductoController"
            stylesheets="@/styles/styles.css"
            prefWidth="700" 
            prefHeight="800">
    
    <header>
        <VBox spacing="10">
            <Text style="-fx-font-size: 1.5em; -fx-font-weight: bold;" 
                  fx:id="txtTitulo" />
            <Text style="-fx-font-size: 0.9em; -fx-text-fill: #666;" 
                  text="Complete los datos del producto" />
        </VBox>
    </header>
    
    <content>
        <ScrollPane fitToWidth="true" vbarPolicy="AS_NEEDED" hbarPolicy="NEVER" style="-fx-background: #f5f5f5;">
            <VBox style="-fx-padding: 20; -fx-spacing: 20; -fx-max-width: Infinity;" alignment="CENTER">
                <GridPane hgap="15" vgap="15" style="-fx-padding: 20; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 2);" alignment="TOP_CENTER">
                    <columnConstraints>
                        <ColumnConstraints hgrow="NEVER" minWidth="150" prefWidth="150"/>
                        <ColumnConstraints hgrow="ALWAYS" minWidth="300" prefWidth="300"/>
                    </columnConstraints>
            
                    <!-- Fila 1: Nombre y Categoría -->
                    <Label text="Nombre del Producto*" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="0" GridPane.columnIndex="1" spacing="2">
                        <TextField fx:id="txtNombre" promptText="Ej: Hamburguesa Clásica" styleClass="input-field"/>
                        <Label fx:id="lblErrorNombre" styleClass="error-label"/>
                    </VBox>
            
                    <Label text="Categoría*" GridPane.rowIndex="1" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="1" GridPane.columnIndex="1" spacing="2">
                        <ComboBox fx:id="cmbCategoria" promptText="Seleccione una categoría" styleClass="input-field"/>
                        <Label fx:id="lblErrorCategoria" styleClass="error-label"/>
                    </VBox>
            
                    <!-- Fila 2: Precio y Disponibilidad -->
                    <Label text="Precio*" GridPane.rowIndex="2" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="2" GridPane.columnIndex="1" spacing="2">
                        <HBox spacing="5" alignment="CENTER_LEFT">
                            <TextField fx:id="txtPrecio" promptText="0.00" styleClass="input-field" style="-fx-pref-width: 200;"/>
                            <Label text="MXN" style="-fx-text-fill: #666;"/>
                        </HBox>
                        <Label fx:id="lblErrorPrecio" styleClass="error-label"/>
                    </VBox>
            
                    <Label text="Disponibilidad" GridPane.rowIndex="3" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="3" GridPane.columnIndex="1" spacing="2" alignment="CENTER_LEFT">
                        <CheckBox fx:id="chkDisponible" text="Disponible" styleClass="check-box" selected="true"/>
                    </VBox>
            
                    <!-- Fila 3: Menú y Stock -->
                    <Label text="Menú" GridPane.rowIndex="4" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="4" GridPane.columnIndex="1" spacing="2">
                        <ComboBox fx:id="cmbMenu" promptText="Seleccione un menú (opcional)" styleClass="input-field"/>
                        <Label fx:id="lblErrorMenu" styleClass="error-label"/>
                    </VBox>
            
                    <Label text="Stock*" GridPane.rowIndex="5" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="5" GridPane.columnIndex="1" spacing="2">
                        <TextField fx:id="txtStock" promptText="Cantidad en inventario" styleClass="input-field" style="-fx-pref-width: 200;"/>
                        <Label fx:id="lblErrorStock" styleClass="error-label"/>
                    </VBox>
            
                    <!-- Fila 4: Descripción (ocupa dos columnas) -->
                    <Label text="Descripción*" GridPane.rowIndex="6" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="6" GridPane.columnIndex="1" spacing="2">
                        <TextArea fx:id="txtDescripcion" promptText="Descripción detallada del producto" 
                                wrapText="true" prefRowCount="4" styleClass="input-field"/>
                        <Label fx:id="lblErrorDescripcion" styleClass="error-label"/>
                    </VBox>
            
                    <!-- Fila 5: Imagen del producto -->
                    <Label text="Imagen del Producto" GridPane.rowIndex="7" GridPane.columnIndex="0" styleClass="label"/>
                    <VBox GridPane.rowIndex="7" GridPane.columnIndex="1" spacing="10" style="-fx-padding: 15; -fx-background-color: #f8f9fa; -fx-background-radius: 8; -fx-border-color: #e0e0e0; -fx-border-radius: 8; -fx-border-width: 1;">
                        <!-- Vista previa de la imagen -->
                        <VBox alignment="CENTER" spacing="10">
                            <ImageView fx:id="imgVistaPrevia" fitWidth="250" fitHeight="180" 
                                     preserveRatio="true" style="-fx-border-color: #ddd; -fx-border-width: 1; -fx-background-color: white;">
                                <image>
                                    <Image url="@../../../../images/placeholder-product.png"/>
                                </image>
                            </ImageView>
                            <Label fx:id="lblNombreArchivo" text="Ninguna imagen seleccionada" style="-fx-text-fill: #666;"/>
                        </VBox>
                        
                        <!-- Botón para seleccionar imagen -->
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Button text="Seleccionar Imagen" onAction="#seleccionarImagen" styleClass="btn-secundario" style="-fx-padding: 8 16;"/>
                            <Label text="Formatos: JPG, PNG (Máx. 5MB)" style="-fx-text-fill: #666; -fx-font-size: 12;"/>
                        </HBox>
                        
                        <Label fx:id="lblErrorImagen" styleClass="error-label"/>
                    </VBox>
                    
                    <!-- Campos ocultos para la URL de la imagen y public_id -->
                    <TextField fx:id="txtImagenUrl" visible="false" managed="false"/>
                    <TextField fx:id="txtImagenPublicId" visible="false" managed="false"/>
                    
                    <!-- Botones de acción -->
                    <HBox GridPane.rowIndex="8" GridPane.columnSpan="2" spacing="15" alignment="CENTER_RIGHT" style="-fx-padding: 20 0 0 0;">
                        <Button text="Cancelar" onAction="#cancelar" styleClass="btn-secundario" style="-fx-padding: 8 24;"/>
                        <Button text="Guardar Producto" onAction="#guardarProducto" styleClass="btn-primario" style="-fx-padding: 8 24; -fx-font-weight: bold;"/>
                    </HBox>
                </GridPane>
            </VBox>
        </ScrollPane>
    </content>
</DialogPane>
